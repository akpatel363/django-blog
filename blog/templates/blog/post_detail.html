{% extends 'blog/main.html' %}
{% load blog_tags %}
{% block title %}
    <title>{{ post.title }}</title>
{% endblock title %}
{% block content %}
    <div>
        <h2 class="my-2">{{ post.title|title }}</h2>
        {% for tag in post.tags.all %}
            <a href="{% url 'blog:post_list_by_tag' tag.slug %}" class="badge badge-pill badge-success">{{ tag }}</a>
        {% endfor %}
        <p class="h5">Published by {{ post.author }} on {{ post.publish|date:"DATETIME_FORMAT" }}</p>
        <p>{{ post.body|markdown }}</p>
        <a href="{% url 'blog:post_share' post.id %}" class="btn btn-primary">Share</a>
        <h4 class="mt-3">Similar Posts</h4>
        {% for post in similar_posts %}
            <h5><a href="{{ post.get_absolute_path }}">{{ post.title }}</a></h5>
        {% empty %}
            <h6>No Similar Posts.</h6>
        {% endfor %}
        <hr>
        <div class="row">
            <div class="col-xl-8 col-lg-8 col-md-7 col-12">
                {% with comments.count as total_comments %}
                    <h6 class="my-3">{{total_comments}} comment{{total_comments|pluralize}}</h6>
                {% endwith %}
                {% for comment in comments %}
                    <div class="pl-4 my-1 py-1 d-block {% cycle 'bg-white' 'bg-light' %}" style="border-left: 3px solid black">
                        <p class="my-1">Comment by {{ comment.name }} on {{ comment.created }}</p>
                        <h5>{{ comment.body }}</h5>
                    </div>
                {% empty %}
                    <h3>No Comments Yet.</h3>
                {% endfor %}
                {% if new_comment %}
                    <div class="alert alert-success">Your comment has been added.</div>
                {% endif %}
            </div>
            <div class="col-xl-4 col-lg-4 col-md-5 col-12">
                <h4 class="my-3">Add a comment</h4>
                <form method="post">
                    {% csrf_token %}
                    {{ comment_form.as_p }}
                    <input type="submit" value="Add Comment" class="btn btn-success">
                </form>
            </div>
        </div>
    </div>
{% endblock content %}